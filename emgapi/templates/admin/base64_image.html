<div>
    <input id="{{ widget.name }}-selector" type="file" name="{{ widget.name }}-selector" accept="image/png, image/svg+xml">
    <img id="{{ widget.name }}-preview" src="{% if widget.value != None %}{{ widget.value}}{% else %}{{ "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+Cjxzdmcgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEwMCAxMDAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgeG1sbnM6c2VyaWY9Imh0dHA6Ly93d3cuc2VyaWYuY29tLyIgc3R5bGU9ImZpbGwtcnVsZTpldmVub2RkO2NsaXAtcnVsZTpldmVub2RkO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDoyOyI+CiAgICA8ZyB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwxLC02Ljk1NjUsLTEwLjc1NzgpIj4KICAgICAgICA8Y2lyY2xlIGN4PSI1Ni45NTciIGN5PSI2MC43NTgiIHI9IjQzLjc5MSIgc3R5bGU9ImZpbGw6cmdiKDE3OSwyMjAsMjIzKTsiLz4KICAgIDwvZz4KICAgIDxwYXRoIGQ9Ik03OS4xMDUsNDMuMDQzQzc5LjEwNSwzOS41NDYgNzYuMjY1LDM2LjcwNiA3Mi43NjgsMzYuNzA2TDI1Ljc0NywzNi43MDZDMjIuMjUsMzYuNzA2IDE5LjQxMSwzOS41NDYgMTkuNDExLDQzLjA0M0wxOS40MTEsNjMuMDAxQzE5LjQxMSw2Ni40OTggMjIuMjUsNjkuMzM4IDI1Ljc0Nyw2OS4zMzhMNzIuNzY4LDY5LjMzOEM3Ni4yNjUsNjkuMzM4IDc5LjEwNSw2Ni40OTggNzkuMTA1LDYzLjAwMUw3OS4xMDUsNDMuMDQzWiIgc3R5bGU9ImZpbGw6cmdiKDU5LDEwNyw5NSk7Ii8+CiAgICA8ZyB0cmFuc2Zvcm09Im1hdHJpeCgwLjEzNDI1OCwwLDAsMC43MzY1MDksMjAuNDQ1NywxMy45NzA4KSI+CiAgICAgICAgPHBhdGggZD0iTTc5LjEwNSw0MS4xMzNDNzkuMTA1LDM4LjY5IDY4LjIyMywzNi43MDYgNTQuODIsMzYuNzA2TDQzLjY5NSwzNi43MDZDMzAuMjkyLDM2LjcwNiAxOS40MTEsMzguNjkgMTkuNDExLDQxLjEzM0wxOS40MTEsNjQuOTExQzE5LjQxMSw2Ny4zNTQgMzAuMjkyLDY5LjMzOCA0My42OTUsNjkuMzM4TDU0LjgyLDY5LjMzOEM2OC4yMjMsNjkuMzM4IDc5LjEwNSw2Ny4zNTQgNzkuMTA1LDY0LjkxMUw3OS4xMDUsNDEuMTMzWiIgc3R5bGU9ImZpbGw6cmdiKDEyNSwxOTYsMTIyKTsiLz4KICAgIDwvZz4KICAgIDxnIHRyYW5zZm9ybT0ibWF0cml4KDAuNTM1Njc3LDAsMCwwLjM5NDU0MiwyMi44NzY1LDE1Ljk1MDgpIj4KICAgICAgICA8cGF0aCBkPSJNNzguODk4LDQ2LjQ3OUM3Ni41Myw0MS4yNDQgNzUuODcyLDM2LjcwNiA3MS44OTEsMzYuNzA2TDI2LjYyNCwzNi43MDZDMjIuNjQzLDM2LjcwNiAyMC45ODQsNDEuNDUxIDE5LjQxMSw0Ni41TDE1Ljc0Myw2MS4wNzJDMTUuNzQzLDY2LjQ3OCAyMi42NDMsNjkuMzM4IDI2LjYyNCw2OS4zMzhMNzEuODkxLDY5LjMzOEM3NS44NzIsNjkuMzM4IDgyLjc1NCw2NS4xMjggODIuNzU0LDU5LjcyMkw3OC44OTgsNDYuNDc5WiIgc3R5bGU9ImZpbGw6cmdiKDU5LDEwNyw5NSk7Ii8+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwxLC01LjE2MTEsLTMuNTgzODMpIj4KICAgICAgICA8Y2lyY2xlIGN4PSI1NS4zNTkiIGN5PSI1Ni4wMTkiIHI9IjEzLjI2MSIgc3R5bGU9ImZpbGw6cmdiKDEyNSwxOTYsMTIyKTsiLz4KICAgIDwvZz4KICAgIDxnIHRyYW5zZm9ybT0ibWF0cml4KDAuODMwMDM3LDAsMCwwLjgzMDAzNyw0LjI0NzgxLDUuOTM3MykiPgogICAgICAgIDxjaXJjbGUgY3g9IjU1LjM1OSIgY3k9IjU2LjAxOSIgcj0iMTMuMjYxIiBzdHlsZT0iZmlsbDpyZ2IoNTksMTA3LDk1KTsiLz4KICAgIDwvZz4KICAgIDxnIHRyYW5zZm9ybT0ibWF0cml4KDAuMTMzMjE5LDAsMCwwLjA5MDUzNDMsNjQuODI5NCwzNS44OTA3KSI+CiAgICAgICAgPHBhdGggZD0iTTc5LjEwNSw0OC4xMUM3OS4xMDUsNDEuODE2IDc1LjYzMiwzNi43MDYgNzEuMzU0LDM2LjcwNkwyNy4xNjEsMzYuNzA2QzIyLjg4MywzNi43MDYgMTkuNDExLDQxLjgxNiAxOS40MTEsNDguMTFMMTkuNDExLDU3LjkzNEMxOS40MTEsNjQuMjI4IDIyLjg4Myw2OS4zMzggMjcuMTYxLDY5LjMzOEw3MS4zNTQsNjkuMzM4Qzc1LjYzMiw2OS4zMzggNzkuMTA1LDY0LjIyOCA3OS4xMDUsNTcuOTM0TDc5LjEwNSw0OC4xMVoiIHN0eWxlPSJmaWxsOnJnYigxMjUsMTk2LDEyMik7Ii8+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwxLDMxLjA4NjEsMjEuOTgwNCkiPgogICAgICAgIDxjaXJjbGUgY3g9IjM3LjAzMiIgY3k9IjE3LjgwOCIgcj0iMS41MzMiIHN0eWxlPSJmaWxsOndoaXRlOyIvPgogICAgPC9nPgogICAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMS42MTg2OSwwLDAsMS42MTg2OSwxNS41NTMyLDcuOTI1MjgpIj4KICAgICAgICA8Y2lyY2xlIGN4PSIzNy4wMzIiIGN5PSIxNy44MDgiIHI9IjEuNTMzIiBzdHlsZT0iZmlsbDp3aGl0ZTsiLz4KICAgIDwvZz4KICAgIDxnIHRyYW5zZm9ybT0ibWF0cml4KDIuOTQzMzIsMCwwLDIuOTQzMzIsLTM1LjY4NjEsLTcuOTM5NDYpIj4KICAgICAgICA8Y2lyY2xlIGN4PSIzNy4wMzIiIGN5PSIxNy44MDgiIHI9IjEuNTMzIiBzdHlsZT0iZmlsbDp3aGl0ZTsiLz4KICAgIDwvZz4KICAgIDxnIHRyYW5zZm9ybT0ibWF0cml4KDEsMS4xMTAyMmUtMTYsLTEuMTEwMjJlLTE2LDEsLTYuOTU2NSwtMTAuNzU3OCkiPgogICAgICAgIDxjaXJjbGUgY3g9IjU2Ljk1NyIgY3k9IjYwLjc1OCIgcj0iNDMuNzkxIiBzdHlsZT0iZmlsbDpub25lOyIvPgogICAgICAgIDxjbGlwUGF0aCBpZD0iX2NsaXAxIj4KICAgICAgICAgICAgPGNpcmNsZSBjeD0iNTYuOTU3IiBjeT0iNjAuNzU4IiByPSI0My43OTEiLz4KICAgICAgICA8L2NsaXBQYXRoPgogICAgICAgIDxnIGNsaXAtcGF0aD0idXJsKCNfY2xpcDEpIj4KICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMC43MDcxMDcsMC43MDcxMDcsLTAuNzA3MTA3LDAuNzA3MTA3LDU3LjY3NDMsLTEwLjE2MjQpIj4KICAgICAgICAgICAgICAgIDxyZWN0IHg9IjQ2LjE2MSIgeT0iMi45NDgiIHdpZHRoPSI1LjAwNSIgaGVpZ2h0PSI5NC4yNDIiIHN0eWxlPSJmaWxsOnJnYigyNDIsMTI2LDQ2KTsiLz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+Cg==" }}{% endif %}" height="100px"/>
    <input id="{{ widget.name }}" type="hidden" name="{{ widget.name }}"{% if widget.value != None %} value="{{ widget.value|stringformat:'s' }}"{% endif %}{% include "django/forms/widgets/attrs.html" %}>
    <p>Ideally .svg. Small .png also acceptable.</p>
</div>
{% block extrahead %}
    <script type="text/javascript">
        (function($) {
            $(document).ready(function() {
                $("#{{ widget.name }}-selector").change(function() {
                    const files = document.getElementById('{{ widget.name }}-selector').files;
                    if (files.length > 0) {
                        const image = files[0];
                        const reader = new FileReader();
                        reader.readAsDataURL(image);
                        reader.onload = function () {
                            const b64EncodedImage = reader.result;
                            document.getElementById('{{ widget.name }}').value = b64EncodedImage;
                            document.getElementById('{{ widget.name }}-preview').src = b64EncodedImage;
                        };
                        reader.onerror = function (error) {
                            alert('Error: ', error);
                        };
                    }
                });
            });

        })(grp.jQuery);
    </script>
{% endblock %}