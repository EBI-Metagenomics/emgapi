services:
  - mysql:5.6
variables:
  # Configure mysql environment variables (https://hub.docker.com/r/_/mysql/)
  MYSQL_ALLOW_EMPTY_PASSWORD=yes
  MYSQL_DATABASE=emg

stages:
  - test

test:
  stage: test
  before_script:
    - pip install flake8 pycodestyle pep8-naming
    - python setup.py sdist
    - pip install "git+git://github.com/ola-t/django-rest-framework-json-api@develop#egg=djangorestframework-jsonapi"
    - SRCDIR=$(pwd) docker/run.sh install

    - flake8 --version
    - flake8 -v .
    - mkdir -p ~/.yamjam && cp travis/config.yaml ~/.yamjam/

  script:
    - python setup.py test
